@model List<S2_L3.Models.Sala>
@{
    ViewData["Title"] = "Cinema Multisala";
}

<h2 class="text-center">Cinema Multisala - Prenotazioni</h2>

<div class="container mt-4">
    <div class="row">
        <div class="col-md-6">
            <h4>Stato delle Sale</h4>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Sala</th>
                        <th>Biglietti Venduti</th>
                        <th>Biglietti Ridotti</th>
                        <th>Posti Disponibili</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var sala in Model)
                    {
                        <tr>
                            <td>@sala.Nome</td>
                            <td>@sala.BigliettiVenduti / @sala.CapienzaMassima</td>
                            <td>@sala.BigliettiRidotti</td>
                            <td>@(sala.CapienzaMassima - sala.BigliettiVenduti)</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="col-md-6">
            <h4>Effettua una Prenotazione</h4>
            <form id="formPrenotazione">
                <div class="mb-2">
                    <label>Nome:</label>
                    <input type="text" id="nome" name="nome" class="form-control" required>
                </div>
                <div class="mb-2">
                    <label>Cognome:</label>
                    <input type="text" id="cognome" name="cognome" class="form-control" required>
                </div>
                <div class="mb-2">
                    <label>Sala:</label>
                    <select id="sala" name="sala" class="form-control" required>
                        <option value="SALA NORD">SALA NORD</option>
                        <option value="SALA EST">SALA EST</option>
                        <option value="SALA SUD">SALA SUD</option>
                    </select>
                </div>
                <div class="mb-2">
                    <label>Tipo di Biglietto:</label>
                    <select id="tipo" name="tipo" class="form-control" required>
                        <option value="Intero">Intero</option>
                        <option value="Ridotto">Ridotto</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Prenota</button>
            </form>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#formPrenotazione").submit(function (event) {
            event.preventDefault();
            $.ajax({
                type: "POST",
                url: "/Prenotazione/EffettuaPrenotazione",
                data: $(this).serialize(),
                success: function () {
                    location.reload();
                },
                error: function () {
                    alert("Errore nella prenotazione. Controlla i dati e riprova.");
                }
            });
        });
    });
</script>
